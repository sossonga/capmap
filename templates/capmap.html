<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>capmap Output</title>

    <!-- bootstrap CDN import -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="capmap.css">
    <script src="zoom.js" type="text/javascript"></script>
</head>
<body>
    <h1>capmap</h1>
    <h3>Network Graph:</h3>
    <img id="net-img" src="../graph-output/net-map.svg" width="100%" height="500em" alt="The Network Graph">
    <h3>Statistics:</h3>
    <h4>Conversations</h4>
    <table class="table-bordered">
        <tr>
            <th scope="col">Conversations</th>
            <th scope="col"># of Times</th>
        </tr>
        {% for key, value in packets.items() %}
        <tr>
            <td>{{ key }}</td>
            <td>{{ value }}</td>
            {% for line in lengths %}
                <td>{{ line }}</td>
            {% endfor %}
        </tr>
        {% endfor %}
    </table>
    <br>
    <h4>DNS Queries</h4>
    <table class="table-bordered">
        <tr>
            <th scope="col">Source IP</th>
            <th scope="col">Source Port</th>
            <th scope="col">DNS Query</th>
            <th scope="col">Destination IP</th>
            <th scope="col">Destination Port</th>
        </tr>
        {% for line in dns %}
        <tr>
            <td>{{ line[0] }}</td>
            <td>{{ line[1] }}</td>
            <td>{{ line[2] }}</td>
            <td>{{ line[3] }}</td>
            <td>{{ line[4] }}</td>
        </tr>
        {% endfor %}
    </table>
    <br>
    <h4>ARP Requests and Replies</h4>
    <p>Request: 1 / Reply: 2</p>
    <table class="table-bordered">
        <tr>
            <th>Source IP</th>
            <th>Destination IP</th>
            <th>Opcode</th>
        </tr>
        {% for line in arp %}
        <tr>
            <td>{{ line[0] }}</td>
            <td>{{ line[1] }}</td>
            <td>{{ line[2] }}</td>
        </tr>
        {% endfor %}
    </table>
    <br>
    <h4>Ports</h4>
    <table class="table-bordered">
        <tr>
            <th scope="col">Port Number</th>
            <th scope="col"># Times Used</th>
        </tr>
        {% for key, value in ports.items() %}
        <tr>
            <td>{{ key }}</td>
            <td>{{ value }}</td>
        </tr>
        {% endfor %}
    </table>
    <br>
    <h4>Transport Protocols</h4>
    {% for key, value in trans.items() %}
        <p>{{ key }} Packets Transmitted: {{ value }}</p>
    {% endfor %}
</body>
</html>